import{_ as x,r as p,o as u,c as _,b as e,d as a,w as $,n as m,F as V,f as y,g as E,t as h,h as I,v as k}from"./index-30b6f64c.js";const{VITE_URL:L,VITE_PATH:T}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payroom",BASE_URL:"/week7/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},U={data(){return{user:{}}},methods:{sentOrder(){const l={user:this.user};this.$http.post(`${L}/v2/api/${T}/order`,{data:l}).then(t=>{alert(t.data.message),this.getCart(),this.$refs.userForm.resetForm()}).catch(t=>{console.log(t)})},isPhone(l){return/^(09)[0-9]{8}$/.test(l)?!0:"需要正確的電話號碼"}},props:["getCart","cart"]},F={class:"row justify-content-center"},R={class:"col-4"},S={class:"mb-3"},w=e("label",{for:"name",class:"h5"},"姓名:",-1),A={class:"mb-3"},O=e("label",{for:"tel",class:"h5"},"電話:",-1),P={class:"mb-3"},D=e("label",{for:"email",class:"h5"},"電子郵件:",-1),q={class:"mb-3"},N=e("label",{for:"address",class:"h5"},"地址:",-1),B={class:"mb-3"},H=e("label",{for:"message",class:"h5"},"附註:",-1),M={class:"text-center"},j=["disabled"];function z(l,t,g,C,s,c){const r=p("VField"),i=p("ErrorMessage"),b=p("VForm");return u(),_("div",F,[e("div",R,[a(b,{onSubmit:c.sentOrder,class:"my-5",ref:"userForm"},{default:$(({errors:d})=>{var n;return[e("div",S,[w,a(r,{id:"name",name:"姓名",type:"text",class:m(["form-control",{"is-invalid":d.姓名}]),placeholder:"請輸入 姓名",rules:"required",modelValue:s.user.name,"onUpdate:modelValue":t[0]||(t[0]=o=>s.user.name=o)},null,8,["class","modelValue"]),a(i,{name:"姓名",class:"invalid-feedback"})]),e("div",A,[O,a(r,{id:"tel",name:"電話",type:"tel",class:m(["form-control",{"is-invalid":d.電話}]),placeholder:"請輸入 電話",rules:c.isPhone,modelValue:s.user.tel,"onUpdate:modelValue":t[1]||(t[1]=o=>s.user.tel=o)},null,8,["class","rules","modelValue"]),a(i,{name:"電話",class:"invalid-feedback"})]),e("div",P,[D,a(r,{id:"email",name:"電子郵件",type:"email",class:m(["form-control",{"is-invalid":d.電子郵件}]),placeholder:"請輸入 電子郵件",rules:"required||email",modelValue:s.user.email,"onUpdate:modelValue":t[2]||(t[2]=o=>s.user.email=o)},null,8,["class","modelValue"]),a(i,{name:"電子郵件",class:"invalid-feedback"})]),e("div",q,[N,a(r,{id:"address",name:"地址",type:"text",class:m(["form-control",{"is-invalid":d.地址}]),placeholder:"請輸入 地址",rules:"required",modelValue:s.user.address,"onUpdate:modelValue":t[3]||(t[3]=o=>s.user.address=o)},null,8,["class","modelValue"]),a(i,{name:"地址",class:"invalid-feedback"})]),e("div",B,[H,a(r,{id:"message",name:"附註",type:"text",class:m(["form-control",{"is-invalid":d.附註}]),placeholder:"請輸入 附註",modelValue:s.user.message,"onUpdate:modelValue":t[4]||(t[4]=o=>s.user.message=o),as:"textarea",cols:"10",rows:"10"},null,8,["class","modelValue"]),a(i,{name:"地址",class:"invalid-feedback"})]),e("div",M,[e("button",{type:"submit",class:"btn btn-primary w-100",disabled:!((n=g.cart.carts)!=null&&n.length)}," 送出 ",8,j)])]}),_:1},8,["onSubmit"])])])}const X=x(U,[["render",z]]),{VITE_URL:f,VITE_PATH:v}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payroom",BASE_URL:"/week7/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},G={data(){return{cart:{},loadingItem:"",isLoading:!1}},methods:{getCart(){this.isLoading=!0,this.$http.get(`${f}/v2/api/${v}/cart`).then(l=>{this.cart=l.data.data,this.isLoading=!1}).catch(l=>{console.log(l)})},deleteCartItem(l){this.loadingItem=l,this.$http.delete(`${f}/v2/api/${v}/cart/${l}`).then(()=>{this.getCart()}).catch(t=>{console.log(t)})},deleteCartAll(){this.loadingItem="all",this.$http.delete(`${f}/v2/api/${v}/carts`).then(()=>{this.getCart()}).catch(l=>{console.log(l)})},updateItemNum(l){const t={product_id:l.product.id,qty:l.qty};this.$http.put(`${f}/v2/api/${v}/cart/${l.id}`,{data:t}).then(()=>{this.getCart()}).catch(g=>{console.log(g.response.data.message)})}},mounted(){this.getCart()},components:{OrderForm:X}},J={class:"vl-parent"},K=e("h3",{class:"mt-5 mb-3 text-center"},"購物車",-1),Q={class:"table mt-5 align-middle"},W=e("thead",null,[e("tr",null,[e("th"),e("th",null,"商品名稱"),e("th",null,"數量/單位"),e("th",{class:"text-end"},"單價"),e("th",{class:"text-end"},"總價")])],-1),Y=["disabled","onClick"],Z=["onUpdate:modelValue","onChange"],ee=["value"],te={class:"text-end"},se={class:"text-end"},le={key:1},oe=e("td",{colspan:"5",class:"text-center"},"目前購物車中沒有東西喔",-1),ne=[oe],ae={key:0},de=e("td",null,null,-1),ce=e("td",null,null,-1),re=e("td",null,null,-1),ie=e("td",null,null,-1),ue={class:"text-end"},_e=["disabled"],he=e("td",null,null,-1),me=e("td",null,null,-1),pe=e("td",null,null,-1),ge=e("td",{class:"text-end"},"總金額",-1),be={class:"text-end"},fe=e("td",null,null,-1),ve=e("td",null,null,-1),Ve=e("td",null,null,-1),ye=e("td",{class:"text-end"},"付款金額",-1),xe={class:"text-end"};function Ce(l,t,g,C,s,c){var b,d;const r=p("VLoading"),i=p("OrderForm");return u(),_(V,null,[e("div",J,[a(r,{active:s.isLoading,"onUpdate:active":t[0]||(t[0]=n=>s.isLoading=n),"can-cancel":!1,"is-full-page":!0},null,8,["active"])]),K,e("table",Q,[W,e("tbody",null,[(b=s.cart.carts)!=null&&b.length?(u(!0),_(V,{key:0},y(s.cart.carts,n=>(u(),_("tr",{key:n.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:s.loadingItem===n.id,onClick:o=>c.deleteCartItem(n.id)}," X ",8,Y)]),e("td",null,h(n.product.title),1),e("td",null,[I(e("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":o=>n.qty=o,onChange:o=>c.updateItemNum(n)},[(u(),_(V,null,y(15,o=>e("option",{value:o,key:o+"123"},h(o),9,ee)),64))],40,Z),[[k,n.qty]])]),e("td",te,h(n.product.price),1),e("td",se,h(n.final_total),1)]))),128)):(u(),_("tr",le,ne))]),e("tfoot",null,[(d=s.cart.carts)!=null&&d.length?(u(),_("tr",ae,[de,ce,re,ie,e("td",ue,[e("button",{type:"button",class:"btn btn-outline-danger",disabled:s.loadingItem==="all",onClick:t[1]||(t[1]=n=>c.deleteCartAll())}," 清空全部 ",8,_e)])])):E("",!0),e("tr",null,[he,me,pe,ge,e("td",be,h(s.cart.total),1)]),e("tr",null,[fe,ve,Ve,ye,e("td",xe,h(s.cart.final_total),1)])])]),a(i,{cart:s.cart,"get-cart":c.getCart},null,8,["cart","get-cart"])],64)}const Ee=x(G,[["render",Ce]]);export{Ee as default};
